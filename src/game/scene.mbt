enum Scene {
  Welcome
  Fight
  FightAnime
  Victory
  Defeat
  Bonus
  World
  Secret
} derive(Eq, Show)

enum BounsScene {
  LevelUp
  None
}

fn Game::background() -> Unit {
  @wasm.set_draw_colors(1, index=1)
}

let castle : @wasm.Sprite = @wasm.sprite(
  b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x50\x00\x00\x00\x00\x00\x00\x00\x01\xa9\x00\x00\x00\x00\x00\x00\x00\x01\xa9\x40\x00\x00\x00\x00\x00\x00\x01\xa9\x40\x00\x00\x00\x00\x00\x00\x01\xa9\x40\x00\x00\x00\x00\x00\x00\x77\x77\x74\x00\x00\x00\x00\x00\x00\xff\xff\xfc\x00\x00\x00\x00\x00\x00\x7f\xff\xf4\x00\x00\x00\x00\x00\x00\x2a\xaa\xa0\x00\x00\x00\x00\x00\x00\x0f\xff\x80\x00\x00\x00\x00\x00\x10\x0f\xdf\x80\x01\x00\x00\x00\x00\x10\x0f\xdf\x80\x01\x00\x00\x00\x00\x10\x0f\xdf\x80\x01\x00\x00\x00\x00\x10\x07\x77\x40\x01\x00\x00\x00\x00\x54\x0f\xff\xe0\x05\x40\x00\x00\x01\xa9\x0f\xff\xe0\x1a\x90\x00\x00\x06\xaa\x43\xff\xe0\x6a\xa4\x00\x00\x07\xfe\x42\xaa\xa0\x6a\xa4\x00\x00\x07\xfe\x43\xff\x80\x7f\xe4\x00\x00\x03\xde\x03\xff\x80\x7f\xe4\x00\x00\x03\xde\x03\xff\x80\x7f\xe4\x00\x00\x03\xfe\x03\xff\x80\x3d\xa0\x00\x00\x03\xfe\x03\xff\x80\x3d\xa0\x00\x00\x03\xfe\x0f\xff\x80\x3f\xe0\x00\x00\x03\xfe\x0f\xff\x80\x3f\xe0\x00\x00\x03\xfe\x0f\xff\x80\x3f\xe4\x00\x00\x07\xfe\x0f\xff\x80\xff\xe4\x00\x00\x07\xfe\x0f\xff\x80\xff\xe4\x00\x00\x07\xfe\x0f\xff\x80\xff\xe4\x00\x00\x07\xfe\x0f\xff\x80\x15\x7d\x54\x1d\x5d\xf5\x0f\xff\x80\x1f\xff\xd4\x1f\xfd\xd5\x0f\xff\x80\xbf\xff\xa4\x1f\xfe\x96\x0f\xff\x80\xbf\xff\xa4\x1f\xfe\x96\xff\xff\x80\xbf\xff\xf4\x1f\xff\xd7\xfd\xdd\xff\xff\xff\xf4\x1f\xaa\xbf\xfd\xdd\xff\xff\xef\xf4\x07\xfa\xbf\xff\xff\xff\xff\xfe\xa0\x07\xfe\xbf\xff\xff\xff\xd5\xff\xa0\x07\xfe\xbf\x5f\xff\xff\xd5\xff\xd0\x07\xfe\xbf\x5f\xff\xff\xd5\xff\xd0\x07\xfe\xbf\x5f\xff\xff\xd5\xff\xd0\x07\xfe\xbf\xff\xd5\xff\xff\xff\xd0\x07\xfe\xbf\xff\xd5\xff\xff\xff\xd0\x07\xfe\xbf\xff\x6a\x7f\xff\xff\xd0\x07\xfe\xbf\xff\x6a\x7f\xff\xff\xd0\x06\xaa\xbf\xff\x6a\x7f\xff\xff\xd0\x0a\xaa\xaa\xaa\x6a\x55\x55\x55\x50\x0a\xaa\xaa\xaa\x55\x6a\xaa\xaa\xa0\x00\x00\x00\x00\x00\x00\x00\x00\x00",
)

fn Game::welcome() -> Unit {
  draw_castle()
  // draw_castle(50, @math.maximum(30, 160 - game.g_time / 5))
  if keyboard.button == X && keyboard.pressed {
    game.scene = World
    game.flag = true
    return
  }
  if game.g_time > 360 {
    @wasm.set_draw_colors(2, index=1)
    @wasm.set_draw_colors(0, index=2)
    @wasm.text("Up Dungeons", 35, @math.minimum(15, game.g_time / 4 - 90))
  }
  if game.g_time > 410 {
    if game.g_time % 30 == 0 {
      game.flag = not(game.flag)
    }
    if game.flag {
      @wasm.text("Press X to start", 20, 140)
    }
  }
}

fn draw_castle() -> Unit {
  @wasm.set_draw_colors(index=1, 0)
  @wasm.set_draw_colors(index=2, 4)
  @wasm.set_draw_colors(index=3, 3)
  @wasm.set_draw_colors(index=4, 2)
  castle.blit(
    60,
    @math.maximum(50, 160 - game.g_time / 4),
    36,
    52,
    { one_bit_per_pixel: false, flip_x: false, flip_y: false, rotate: false },
  )
}
